"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.levelHandler = exports.GetUserXP = exports.AddXP = exports.GetGlobalPrestigeXP = exports.GetGlobalXP = void 0;
const index_1 = require("../index");
const index_2 = require("./index");
// const complexity = require('complexity-report');
// const complexityThreshold = 5;
const ratelimit = 60000;
const cooldown = new Map();
function GetGlobalXP(lvl) {
    return Math.trunc((lvl - 1 + 2 * 300 * Math.pow(2, (lvl - 1) / 7)) / 4);
}
exports.GetGlobalXP = GetGlobalXP;
function GetGlobalPrestigeXP(lvl, prestige) {
    return Math.trunc((lvl - 1 + 300 * Math.pow(2, (lvl - 1) / prestige)) / 4);
}
exports.GetGlobalPrestigeXP = GetGlobalPrestigeXP;
function between(min, max) {
    return Math.floor(Math.random() * (max - min + 1) + min);
}
function AddXP(msg, userType) {
    let random = between(20, 40);
    if (userType === "STAFF" || userType === "DEV")
        random = between(40, 180);
    return Math.trunc(random + 1 + (0.1 * msg.content.length));
}
exports.AddXP = AddXP;
async function GetUserXP(user) {
    try {
        return await index_1.prisma.leveling.findUnique({
            where: {
                userId: user
            }
        });
    }
    catch (err) {
        return (0, index_2.log)("error", "Leveling.GetUserXP", `Something went wrong when trying to recieve user data.\n ${err.stack}`);
    }
}
exports.GetUserXP = GetUserXP;
async function levelHandler(msg, levels, user) {
    // Cooldowns
    if (!cooldown.has(msg.author.id)) {
        cooldown.set(msg.author.id, 0);
    }
    if (cooldown.has(msg.author.id)) {
        let messageCount = cooldown.get(msg.author.id);
        console.log(messageCount);
        if (messageCount >= 4)
            return;
        cooldown.set(msg.author.id, messageCount ? messageCount + 1 : 1);
    }
    setTimeout(() => {
        cooldown.set(msg.author.id, 0);
    }, 3000);
    // Give user XP
    if (user) {
        let currentXp = levels.currentXp;
        currentXp += AddXP(msg, user.userType);
        await index_1.prisma.leveling.update({
            where: {
                userId: msg.author.id
            },
            data: {
                currentXp: currentXp
            }
        });
    }
    else {
        await index_1.prisma.leveling.update({
            where: {
                userId: msg.author.id
            },
            data: {
                currentXp: AddXP(msg, user.userType)
            }
        });
    }
    let currentLevel;
    let LevelUpXp = 0;
    for (var i = 2; i < levels.level + 2; i++) {
        LevelUpXp += GetGlobalXP(i);
    }
    if (levels.currentXp >= LevelUpXp) {
        currentLevel = levels.level + 1;
        await index_1.prisma.leveling.update({
            where: {
                userId: msg.author.id
            },
            data: {
                level: currentLevel
            }
        });
        msg.channel.send({ content: `You just leveled up to ${currentLevel}!` });
    }
    // let currentLevel: number;
    // let LevelUpXP = GetGlobalXP(levels.level+1);
    // for (let i = 1; i < levels.level; i++) {
    //     LevelUpXP += GetGlobalXP(i);
    // }
    // if(levels.currentXp >= LevelUpXP) {
    //     currentLevel = levels.level += 1;
    //     await prisma.leveling.update({
    //         where: {
    //             userId: msg.author.id
    //         },
    //         data: {
    //             level: currentLevel
    //         }
    //     });
    //     msg.channel.send({ content: `You just leveled up to ${currentLevel}!` });
    // }
}
exports.levelHandler = levelHandler;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGV2ZWxpbmcuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvbW9kdWxlcy9sZXZlbGluZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFFQSxvQ0FBa0M7QUFDbEMsbUNBQThCO0FBRTlCLG1EQUFtRDtBQUNuRCxpQ0FBaUM7QUFFakMsTUFBTSxTQUFTLEdBQUcsS0FBSyxDQUFDO0FBQ3hCLE1BQU0sUUFBUSxHQUFHLElBQUksR0FBRyxFQUFFLENBQUM7QUFHM0IsU0FBZ0IsV0FBVyxDQUFDLEdBQVc7SUFDbkMsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDNUUsQ0FBQztBQUZELGtDQUVDO0FBRUQsU0FBZ0IsbUJBQW1CLENBQUMsR0FBVyxFQUFFLFFBQWdCO0lBQzdELE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxHQUFHLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDL0UsQ0FBQztBQUZELGtEQUVDO0FBRUQsU0FBUyxPQUFPLENBQUMsR0FBVyxFQUFFLEdBQVc7SUFDckMsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDLEdBQUcsR0FBRyxHQUFHLEdBQUcsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUE7QUFDNUQsQ0FBQztBQUVELFNBQWdCLEtBQUssQ0FBQyxHQUFZLEVBQUUsUUFBZ0I7SUFDaEQsSUFBSSxNQUFNLEdBQUcs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QUMsRUFBRSxDQUFDLEdBQUcsTUFBTSxDQUFDLEtBQUssR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7UUFDdkMsU0FBUyxJQUFJLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQztLQUMvQjtJQUVELElBQUksTUFBTSxDQUFDLFNBQVMsSUFBSSxTQUFTLEVBQUU7UUFDL0IsWUFBWSxHQUFHLE1BQU0sQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDO1FBQ2hDLE1BQU0sY0FBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUM7WUFDekIsS0FBSyxFQUFFO2dCQUNILE1BQU0sRUFBRSxHQUFHLENBQUMsTUFBTSxDQUFDLEVBQUU7YUFDeEI7WUFDRCxJQUFJLEVBQUU7Z0JBQ0YsS0FBSyxFQUFFLFlBQVk7YUFDdEI7U0FDSixDQUFDLENBQUM7UUFDSCxHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFLE9BQU8sRUFBRSwwQkFBMEIsWUFBWSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0tBQzVFO0lBRUQsNEJBQTRCO0lBQzVCLCtDQUErQztJQUMvQywyQ0FBMkM7SUFDM0MsbUNBQW1DO0lBQ25DLElBQUk7SUFFSixzQ0FBc0M7SUFDdEMsd0NBQXdDO0lBQ3hDLHFDQUFxQztJQUNyQyxtQkFBbUI7SUFDbkIsb0NBQW9DO0lBQ3BDLGFBQWE7SUFDYixrQkFBa0I7SUFDbEIsa0NBQWtDO0lBQ2xDLFlBQVk7SUFDWixVQUFVO0lBQ1YsZ0ZBQWdGO0lBQ2hGLElBQUk7QUFFUixDQUFDO0FBL0VELG9DQStFQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IExldmVsaW5nLCBVc2VycyB9IGZyb20gXCJAcHJpc21hL2NsaWVudFwiO1xyXG5pbXBvcnQgeyBNZXNzYWdlIH0gZnJvbSBcImRpc2NvcmQuanNcIjtcclxuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSBcIi4uL2luZGV4XCI7XHJcbmltcG9ydCB7IGxvZyB9IGZyb20gXCIuL2luZGV4XCI7XHJcblxyXG4vLyBjb25zdCBjb21wbGV4aXR5ID0gcmVxdWlyZSgnY29tcGxleGl0eS1yZXBvcnQnKTtcclxuLy8gY29uc3QgY29tcGxleGl0eVRocmVzaG9sZCA9IDU7XHJcblxyXG5jb25zdCByYXRlbGltaXQgPSA2MDAwMDtcclxuY29uc3QgY29vbGRvd24gPSBuZXcgTWFwKCk7XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIEdldEdsb2JhbFhQKGx2bDogbnVtYmVyKTogbnVtYmVyIHtcclxuICAgIHJldHVybiBNYXRoLnRydW5jKChsdmwgLSAxICsgMiAqIDMwMCAqIE1hdGgucG93KDIsIChsdmwgLSAxKSAvIDcpKSAvIDQpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gR2V0R2xvYmFsUHJlc3RpZ2VYUChsdmw6IG51bWJlciwgcHJlc3RpZ2U6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICByZXR1cm4gTWF0aC50cnVuYygobHZsIC0gMSArIDMwMCAqIE1hdGgucG93KDIsIChsdmwgLSAxKSAvIHByZXN0aWdlKSkgLyA0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gYmV0d2VlbihtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSArIG1pbilcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIEFkZFhQKG1zZzogTWVzc2FnZSwgdXNlclR5cGU6IHN0cmluZykge1xyXG4gICAgbGV0IHJhbmRvbSA9IGJldHdlZW4oMjAsIDQwKTtcclxuICAgIGlmICh1c2VyVHlwZSA9PT0gXCJTVEFGRlwiIHx8IHVzZXJUeXBlID09PSBcIkRFVlwiKSByYW5kb20gPSBiZXR3ZWVuKDQwLCAxODApO1xyXG4gICAgcmV0dXJuIE1hdGgudHJ1bmMocmFuZG9tICsgMSArICgwLjEgKiBtc2cuY29udGVudC5sZW5ndGgpKVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR2V0VXNlclhQKHVzZXI6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gYXdhaXQgcHJpc21hLmxldmVsaW5nLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkOiB1c2VyXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0gY2F0Y2ggKGVycjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIGxvZyhcImVycm9yXCIsIFwiTGV2ZWxpbmcuR2V0VXNlclhQXCIsIGBTb21ldGhpbmcgd2VudCB3cm9uZyB3aGVuIHRyeWluZyB0byByZWNpZXZlIHVzZXIgZGF0YS5cXG4gJHtlcnIuc3RhY2t9YCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsZXZlbEhhbmRsZXIobXNnOiBNZXNzYWdlLCBsZXZlbHM6IExldmVsaW5nLCB1c2VyOiBVc2Vycyk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgLy8gQ29vbGRvd25zXHJcbiAgICBpZiAoIWNvb2xkb3duLmhhcyhtc2cuYXV0aG9yLmlkKSkge1xyXG4gICAgICAgIGNvb2xkb3duLnNldChtc2cuYXV0aG9yLmlkLCAwKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoY29vbGRvd24uaGFzKG1zZy5hdXRob3IuaWQpKSB7XHJcbiAgICAgICAgbGV0IG1lc3NhZ2VDb3VudCA9IGNvb2xkb3duLmdldChtc2cuYXV0aG9yLmlkKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlQ291bnQpXHJcbiAgICAgICAgaWYgKG1lc3NhZ2VDb3VudCA+PSA0KSByZXR1cm47XHJcbiAgICAgICAgY29vbGRvd24uc2V0KG1zZy5hdXRob3IuaWQsIG1lc3NhZ2VDb3VudCA/IG1lc3NhZ2VDb3VudCArIDEgOiAxKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBjb29sZG93bi5zZXQobXNnLmF1dGhvci5pZCwgMCk7XHJcbiAgICB9LCAzMDAwKTtcclxuXHJcbiAgICAvLyBHaXZlIHVzZXIgWFBcclxuICAgIGlmICh1c2VyKSB7XHJcbiAgICAgICAgbGV0IGN1cnJlbnRYcCA9IGxldmVscy5jdXJyZW50WHA7XHJcblxyXG4gICAgICAgIGN1cnJlbnRYcCArPSBBZGRYUChtc2csIHVzZXIudXNlclR5cGUpXHJcbiAgICAgICAgYXdhaXQgcHJpc21hLmxldmVsaW5nLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IG1zZy5hdXRob3IuaWRcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudFhwOiBjdXJyZW50WHBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBhd2FpdCBwcmlzbWEubGV2ZWxpbmcudXBkYXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogbXNnLmF1dGhvci5pZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50WHA6IEFkZFhQKG1zZywgdXNlci51c2VyVHlwZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBjdXJyZW50TGV2ZWw6IG51bWJlcjtcclxuICAgIGxldCBMZXZlbFVwWHAgPSAwO1xyXG4gICAgZm9yICh2YXIgaSA9IDI7IGkgPCBsZXZlbHMubGV2ZWwgKyAyOyBpKyspIHtcclxuICAgICAgICBMZXZlbFVwWHAgKz0gR2V0R2xvYmFsWFAoaSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGxldmVscy5jdXJyZW50WHAgPj0gTGV2ZWxVcFhwKSB7XHJcbiAgICAgICAgY3VycmVudExldmVsID0gbGV2ZWxzLmxldmVsICsgMTtcclxuICAgICAgICBhd2FpdCBwcmlzbWEubGV2ZWxpbmcudXBkYXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogbXNnLmF1dGhvci5pZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBsZXZlbDogY3VycmVudExldmVsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBtc2cuY2hhbm5lbC5zZW5kKHsgY29udGVudDogYFlvdSBqdXN0IGxldmVsZWQgdXAgdG8gJHtjdXJyZW50TGV2ZWx9IWAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gbGV0IGN1cnJlbnRMZXZlbDogbnVtYmVyO1xyXG4gICAgLy8gbGV0IExldmVsVXBYUCA9IEdldEdsb2JhbFhQKGxldmVscy5sZXZlbCsxKTtcclxuICAgIC8vIGZvciAobGV0IGkgPSAxOyBpIDwgbGV2ZWxzLmxldmVsOyBpKyspIHtcclxuICAgIC8vICAgICBMZXZlbFVwWFAgKz0gR2V0R2xvYmFsWFAoaSk7XHJcbiAgICAvLyB9XHJcblxyXG4gICAgLy8gaWYobGV2ZWxzLmN1cnJlbnRYcCA+PSBMZXZlbFVwWFApIHtcclxuICAgIC8vICAgICBjdXJyZW50TGV2ZWwgPSBsZXZlbHMubGV2ZWwgKz0gMTtcclxuICAgIC8vICAgICBhd2FpdCBwcmlzbWEubGV2ZWxpbmcudXBkYXRlKHtcclxuICAgIC8vICAgICAgICAgd2hlcmU6IHtcclxuICAgIC8vICAgICAgICAgICAgIHVzZXJJZDogbXNnLmF1dGhvci5pZFxyXG4gICAgLy8gICAgICAgICB9LFxyXG4gICAgLy8gICAgICAgICBkYXRhOiB7XHJcbiAgICAvLyAgICAgICAgICAgICBsZXZlbDogY3VycmVudExldmVsXHJcbiAgICAvLyAgICAgICAgIH1cclxuICAgIC8vICAgICB9KTtcclxuICAgIC8vICAgICBtc2cuY2hhbm5lbC5zZW5kKHsgY29udGVudDogYFlvdSBqdXN0IGxldmVsZWQgdXAgdG8gJHtjdXJyZW50TGV2ZWx9IWAgfSk7XHJcbiAgICAvLyB9XHJcblxyXG59Il19