datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

generator client {
    provider = "prisma-client-js"
}

// guild models

model Guild {
    id          String       @id @unique
    settings    Settings[]
    guildType   GuildType    @default(NORMAL)
    blacklisted Boolean      @default(false)
    GuildUsers  GuildUsers[]
}

model GuildUsers {
    guildId String
    guild   Guild  @relation(fields: [guildId], references: [id])
    userId  String
    user    Users  @relation(fields: [userId], references: [id])

    @@id([guildId, userId])
}

model Settings {
    id       String  @id @default(cuid())
    guildId  String?
    guild    Guild?  @relation(fields: [guildId], references: [id])
    prefix   String  @default("?")
    leveling Boolean @default(false)
}

enum GuildType {
    NORMAL
    PREMIUM
}

// user models

model Users {
    id           String         @id @unique
    userType     UserType       @default(NORMAL)
    leveling     Leveling[]
    inventory    Inventory[]
    blacklisted  Boolean        @default(false)
    GuildUsers   GuildUsers[]
    Economy      Economy[]
    UserSettings UserSettings[]
}

model UserSettings {
    canDm  Boolean @default(false)
    userId String
    user   Users   @relation(fields: [userId], references: [id])

    @@id([userId])
}

model Leveling {
    currentXp Int    @default(0)
    level     Int    @default(1)
    prestige  Int    @default(0)
    userId    String
    user      Users  @relation(fields: [userId], references: [id])

    @@id([userId])
}

model Inventory {
    items  String[]
    userId String
    user   Users  @relation(fields: [userId], references: [id])

    @@id([userId])
}

model Economy {
    cash        Int       @default(0)
    bank        Int       @default(5000)
    bankStorage Int       @default(100)
    networth    Int       @default(0)
    streak      Int
    lastDaily   DateTime?
    locked      Boolean   @default(false)

    userId String
    user   Users  @relation(fields: [userId], references: [id])

    @@id([userId])
}

model Item {
    id               String   @id
    name             String
    emoji            String
    description      String?
    aliases          String[]
    shortDescription String?
    stackable        Boolean?
    maxQuanity       Int?
    limited          Boolean  @default(false)
    rarity           Int      @default(0)
    durability       Int      @default(100)
    type             ItemType

    price     Int
    sellPrice Int?
    lootBox   Boolean

    crafting Json?
}

enum UserType {
    NORMAL
    PREMIUM
    STAFF
    DEV
}

enum ItemType {
    CARD
    ITEM
    TOOL
    COLLECTABLE
    PACK
}

enum Powers {
    FIRE
    WATER
    EARTH
    WIND
}
